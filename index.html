<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø³ÙˆÙ‚ Ø§Ù„Ø¯Ù„Ø§Ù„Ø© | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø±Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background: #f8fafc; direction: rtl; }
        .btn-primary { background: #059669; color: white; border-radius: 8px; }
        #pdf-template { display: none; } /* Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ø®ÙÙŠ Ù„Ù„Ù€ PDF */
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [view, setView] = useState("feed");
            const [items, setItems] = useState([{ name: "", qty: "" }]);
            const [orders, setOrders] = useState([
                { id: "S251228", location: "Ø§Ù„Ø®Ø±Ø·ÙˆÙ…ØŒ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†", items: [{name: "Ø³ÙƒØ± ÙƒÙ†Ø§Ù†Ù‡", qty: "10 Ø¬ÙˆØ§Ù„"}] }
            ]);

            // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ®Ø·Ø¦ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ø¨Ø¯Ø§Ù‹
            const downloadPDF = (order) => {
                const element = document.createElement('div');
                element.innerHTML = `
                    <div style="padding: 20px; font-family: Arial; direction: rtl; text-align: right;">
                        <h1 style="color: #059669;">Ø³ÙˆÙ‚ Ø§Ù„Ø¯Ù„Ø§Ù„Ø© - ÙƒØ´Ù Ø·Ù„Ø¨ÙŠØ©</h1>
                        <p><strong>Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹:</strong> ${order.id}</p>
                        <p><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${order.location}</p>
                        <table border="1" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                            <thead>
                                <tr style="background: #059669; color: white;">
                                    <th style="padding: 10px;">Ø§Ù„ØµÙ†Ù</th>
                                    <th style="padding: 10px;">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${order.items.map(it => `
                                    <tr>
                                        <td style="padding: 10px; border: 1px solid #ddd;">${it.name}</td>
                                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">${it.qty}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                
                html2pdf().from(element).set({
                    margin: 10,
                    filename: `Order-${order.id}.pdf`,
                    html2canvas: { scale: 2 },
                    jsPDF: { orientation: 'portrait' }
                }).save();
            };

            const handlePost = (e) => {
                e.preventDefault();
                const fd = new FormData(e.target);
                const message = `ğŸ“¦ *Ø·Ù„Ø¨ ØªÙˆØ±ÙŠØ¯ Ø¬Ø¯ÙŠØ¯*\n*Ø§Ù„Ù…Ø­Ù„:* ${fd.get("shop")}\n*Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:* ${fd.get("user")}\n*Ø§Ù„Ù…ÙˆÙ‚Ø¹:* ${fd.get("loc")}\n----------\n*Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©:*\n${items.map(it => `- ${it.name} (${it.qty})`).join('\n')}`;
                window.open(`https://wa.me/249998615193?text=${encodeURIComponent(message)}`);
            };

            return (
                <div className="max-w-xl mx-auto p-4">
                    <header className="text-center my-6">
                        <h1 className="text-3xl font-bold text-emerald-700">Ø³ÙˆÙ‚ Ø§Ù„Ø¯Ù„Ø§Ù„Ø©</h1>
                    </header>

                    <nav className="flex border-b mb-6">
                        <button onClick={() => setView("feed")} className={`flex-1 py-2 ${view==='feed'?'border-b-2 border-emerald-600':''}`}>Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
                        <button onClick={() => setView("post")} className={`flex-1 py-2 ${view==='post'?'border-b-2 border-emerald-600':''}`}>Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨</button>
                    </nav>

                    {view === "feed" ? (
                        <div>
                            {orders.map(order => (
                                <div key={order.id} className="bg-white p-4 rounded-xl shadow mb-4 border border-slate-200">
                                    <div className="flex justify-between items-center">
                                        <button onClick={() => downloadPDF(order)} className="text-red-500 text-2xl"><i className="fas fa-file-pdf"></i></button>
                                        <div className="text-right">
                                            <p className="text-xs text-slate-400">REF: {order.id}</p>
                                            <h3 className="font-bold">{order.location}</h3>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    ) : (
                        <form onSubmit={handlePost} className="bg-white p-6 rounded-xl shadow space-y-4 text-right">
                            <input required name="shop" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„" className="w-full p-3 border rounded-lg" />
                            <input required name="user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" className="w-full p-3 border rounded-lg" />
                            <input required name="loc" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹" className="w-full p-3 border rounded-lg" />
                            
                            <div className="border-t pt-4">
                                {items.map((it, idx) => (
                                    <div key={idx} className="flex gap-2 mb-2">
                                        <input placeholder="Ø§Ù„ØµÙ†Ù" className="flex-1 p-2 border rounded" onChange={e => {
                                            const n = [...items]; n[idx].name = e.target.value; setItems(n);
                                        }} />
                                        <input placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" className="w-20 p-2 border rounded" onChange={e => {
                                            const n = [...items]; n[idx].qty = e.target.value; setItems(n);
                                        }} />
                                    </div>
                                ))}
                                <button type="button" onClick={() => setItems([...items, {name:"", qty:""}])} className="text-emerald-600 text-sm font-bold">+ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
                            </div>
                            <button type="submit" className="w-full py-4 btn-primary font-bold">Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨</button>
                        </form>
                    )}
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
</body>
</html>
