<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÙˆÙ‚ Ø§Ù„Ø¯Ù„Ø§Ù„Ø© | Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
</head>
<body className="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function App() {
            const [view, setView] = useState("feed");
            const [items, setItems] = useState([{ name: "", qty: "" }]);
            const [orders] = useState([
                { id: "S251228", location: "Ø§Ù„Ø®Ø±Ø·ÙˆÙ… - Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø­Ù„ÙŠ", items: [{name: "Ø³ÙƒØ± Ø²Ù†Ø© 10 ÙƒÙŠÙ„Ùˆ", qty: "50 Ø¬ÙˆØ§Ù„"}] }
            ]);

            const generatePDF = (order) => {
                const element = document.createElement('div');
                element.style.padding = "20px";
                element.style.direction = "rtl";
                element.innerHTML = `
                    <div style="font-family: 'Arial'; text-align: right;">
                        <h1 style="color: #059669; border-bottom: 2px solid #059669;">Ø³ÙˆÙ‚ Ø§Ù„Ø¯Ù„Ø§Ù„Ø© - Ø·Ù„Ø¨ ØªÙˆØ±ÙŠØ¯</h1>
                        <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</strong> ${order.id}</p>
                        <p><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${order.location}</p>
                        <table border="1" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                            <tr style="background: #f3f4f6;">
                                <th style="padding: 8px;">Ø§Ù„ØµÙ†Ù</th>
                                <th style="padding: 8px;">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                            </tr>
                            ${order.items.map(it => `
                                <tr>
                                    <td style="padding: 8px;">${it.name}</td>
                                    <td style="padding: 8px; text-align: center;">${it.qty}</td>
                                </tr>
                            `).join('')}
                        </table>
                    </div>
                `;
                html2pdf().from(element).save(`Order-${order.id}.pdf`);
            };

            const handlePost = (e) => {
                e.preventDefault();
                const fd = new FormData(e.target);
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„: Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„ØŒ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ØŒ ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹
                const message = `ğŸ“¦ *Ø·Ù„Ø¨ ØªÙˆØ±ÙŠØ¯ Ø¬Ø¯ÙŠØ¯*\n*Ø§Ù„Ù…Ø­Ù„:* ${fd.get("shop")}\n*Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:* ${fd.get("user")}\n*Ø§Ù„Ù…ÙˆÙ‚Ø¹:* ${fd.get("loc")}\n----------\n*Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©:*\n${items.map(it => `- ${it.name} (${it.qty})`).join('\n')}`;
                window.open(`https://wa.me/249998615193?text=${encodeURIComponent(message)}`);
            };

            return (
                <div className="max-w-md mx-auto p-4 font-['Cairo']">
                    <h1 className="text-3xl font-bold text-center text-emerald-700 mb-8">Ø³ÙˆÙ‚ Ø§Ù„Ø¯Ù„Ø§Ù„Ø©</h1>
                    
                    <div className="flex mb-6 border-b">
                        <button onClick={() => setView("feed")} className={`flex-1 py-2 ${view==='feed'?'border-b-2 border-emerald-600 font-bold':''}`}>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
                        <button onClick={() => setView("post")} className={`flex-1 py-2 ${view==='post'?'border-b-2 border-emerald-600 font-bold':''}`}>Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨</button>
                    </div>

                    {view === "feed" ? (
                        orders.map(o => (
                            <div key={o.id} className="bg-white p-4 rounded-xl shadow mb-3 flex justify-between items-center">
                                <button onClick={() => generatePDF(o)} className="text-red-500 text-xl"><i className="fas fa-file-pdf"></i></button>
                                <div className="text-right">
                                    <p className="text-xs text-slate-400">{o.id}</p>
                                    <p className="font-bold">{o.location}</p>
                                </div>
                            </div>
                        ))
                    ) : (
                        <form onSubmit={handlePost} className="space-y-4 text-right">
                            <input name="shop" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù„" className="w-full p-3 border rounded-lg" required />
                            <input name="user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" className="w-full p-3 border rounded-lg" required />
                            <input name="loc" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹" className="w-full p-3 border rounded-lg" required />
                            <div className="border-t pt-4">
                                {items.map((it, i) => (
                                    <div key={i} className="flex gap-2 mb-2">
                                        <input placeholder="Ø§Ù„ØµÙ†Ù" className="flex-1 p-2 border rounded" required onChange={e => {
                                            const n = [...items]; n[i].name = e.target.value; setItems(n);
                                        }} />
                                        <input placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" className="w-20 p-2 border rounded text-center" required onChange={e => {
                                            const n = [...items]; n[i].qty = e.target.value; setItems(n);
                                        }} />
                                    </div>
                                ))}
                                <button type="button" onClick={() => setItems([...items, {name:"", qty:""}])} className="text-emerald-600 text-sm">+ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
                            </div>
                            <button className="w-full py-4 bg-emerald-600 text-white rounded-xl font-bold">Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨</button>
                        </form>
                    )}
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
</body>
</html>
